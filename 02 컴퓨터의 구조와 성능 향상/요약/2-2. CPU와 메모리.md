## 1. CPU의 구성과 동작

### 1.1 CPU의 기본 구성
CPU의 구성요소: 산술논리 연산장치, 제어장치, 레지스터
- 산술논리 연산장치: 산술 연산과 논리 연산을 수행
- 제어장치: CPU에서 작업을 지시하는 부분
- 레지스터: CPU 내에 데이터를 임시로 보관하는 곳

### 1.2 CPU의 명령어 처리 과정
CPU는 0과 1의 2진수로 이루어진 기계어만 인식하기 때문에 코드를 실행하려면 컴파일러를 이용하여 기계어로 바꾸어야 한다.
1) CPU가 연산을 하려면 필요한 데이터를 CPU에 가져와 임시로 보관해야 하는데 이때 사용되는 장소가 레지스터이다.
2) 제어장치는 명령어를 해석하여 제어 신호를 보내고 CPU 내의 데이터 흐름을 조절하는 역할을 한다.

### 1.3 레지스터의 종류
CPU는 필요한 데이터를 메모리에서 가져와 레지스터에 저장하고 산술논리 연산장치를 이용하여 연산을 한 후 그 결과를 다시 레지스터에 저장했다가 메모리로 옮긴다.

#### 사용자 가시 레지스터
- 데이터 레지스터(DR): 메모리에서 가져온 데이터를 임시로 보관할 때 사용한다. CPU에 있는 대부분의 레지스터가 데이터 레지스터이기 때문에 일반 레지스터 또는 범용 레지스터라고 부른다.
- 주소 레지스터(AR): 데이터 또는 명령어가 저장된 메모리의 주소를 저장한다.

#### 사용자 불가시 레지스터
- 특수 레지스터: 그 외 특별한 용도로 사용되는 레지스터
  - 프로그램 카운터(PC): 다음에 실행할 명렁어의 주소를 기억하고 있다가 제어장치에 알려준다. 다음에 실행할 명령어의 주소를 가리키기 때문에 명령어 포인터라고도 한다.
  - 명령어 레지스터(IR): 현재 실행 중인 명령어를 저장한다. 제어장치는 명령어 레지스터에 있는 명령을 해석한 후 외부 장치에 적절한 제어 신호를 보낸다.
  - 메모리 주소 레지스터(MAR): 메모리에서 데이터를 가져오거나 반대로 메모리로 데이터를 보낼 떄 주소를 지정하기 위해 사용한다.
  - 메모리 버퍼 레지스터(MBR): 메모리에서 가져온 데이터나 메모리를 옮겨 갈 데이터를 임시로 저장한다. 항상 메모리 주소 레지스터와 함께 동작한다.
- 그 외에도 CPU가 사용하는 레지스터는 아주 많다.
  - 프로그램 상태 레지스터는 산술논리 연산장치와 연결되어 있으며 연산 결과가 어떤지 저장한다.
  - 프로그램 상태 레지스터는 플래그 레지스터, 상태 레지스터, 컨디션 레지스터라고도 불린다.

### 1.4 버스의 종류
버스: CPU와 메모리, 주변장치 간에 데이터를 주고받을 때 사용   
버스에는 다음 작업을 지시하는 제어 신호, 메모리의 위치 정보를 알려주는 주소, 처리할 데이터가 오고 가며 각각 제어 버스, 주소 버스, 데이터 버스에 실린다.

#### 제어 버스
- 제어장치와 연결된 버스로, CPU가 메모리와 주변장치에 다음 어떤 작업을 할지 지시하는 제어 신호가 오고 간다.
- 메모리와 주변장치에서도 작업이 완료되거나 오류가 발생하면 제어 신호를 보내기 때문에 양방향이다.

#### 주소 버스
- 메모리의 데이터를 읽거나 쓸 때 어느 위치에서 작업할 것인지를 알려주는 위치 정보(주소)가 오고 간다.
- 주소 버스는 메모리 주소 레지스터와 연결되어 있으며 단방향이다.
- CPU에서 메모리나 주변장치로 나가는 주소 정보는 있지만 주소 버스를 통해 CPU로 전달되는 정보는 없다.

#### 데이터 버스
- 메모리 버퍼 레지스터와 연결된 버스로 데이터의 이동이 양방향으로 이루어진다.

## 2. 메모리의 종류와 부팅
모든 프로그램은 메모리에 올라와야 실행될 수 있다. 메모리에는 실행에 필요한 프로그램과 데이터가 존재하며, CPU와 협업하여 작업이 이루어진다.

### 2.1 메모리의 종류
메모리는 읽거나 쓸 수 있는 램과 읽기만 가능한 롬으로 구분된다.   
램은 전력이 끊기면 데이터가 사라지는 휘발성 메모리와 전력이 끊겨도 데이터를 보관할 수 있는 비휘발성 메모리로 나뉜다.   
- 휘발성 메모리: 동적 램(DRAM)과 정적 램(SRAM)이 있다. 
  - 동적 램은 일정 시간이 지나면 사라지므로 일정 시간마다 다시 재생시켜야 한다.
  - 정적 램은 전력이 공급되는 동안에는 데이터를 보관하고 있어 재생할 필요가 없다.
  - 메인 메모리에는 동적 램을, 캐시 같은 고속 메모리에는 정적 램을 사용한다. (정적 램은 속도가 빠르지만 가격이 비싸다.)
  - SDRAM은 DRAM이 발전된 형태로 SRAM과는 완전히 다른 종류의 램이며 SDRAM은 클록틱이 발생할 때마다 데이터를 저장하는 동기 DRAM이다.
- 비휘발성 메모리: 플래시 메모리, FRAM, PRAM 등이 있다.
램과 달리 롬은 전력이 끊겨도 데이터를 보관하는 것이 장점이지만 데이터를 한 번 저장하면 바꿀 수 없다.   
롬의 종류에는 데이터를 지우거나 쓸 수 있는 마스크롬, 전용 기계를 이용하여 데이터를 한 번만 저장할 수 있는 PROM, 데이터를 여러 번 쓰고 지울 수 있는 ERPOM이 있다.   

### 2.2 메모리 보호
일괄 작업 시스템에서는 메모리가 운영체제 영역과 사용자 영역으로 구분된다.   
일괄 작업 시스템에서 메모리 보호는 사용자 영역의 작업이 운영체제 영역으로 침범하지 못하도록 막는 것이다.   
운영체제도 소프트웨어 중 하나라는 사실을 잊지 말아야 한다. 운영체제도 CPU를 사용하는 작업 중 하나이기 때문에 사용자의 작업이 중단되는 동안에는 운영체제의 작업이 잠시 중단된다.   
운영체제의 작업이 중단된 상태에서 사용자의 작업으로부터 메모리를 보호하려면 하드웨어의 도움이 필요하다.   

1) 메모리를 보호하기 위해 CPU는 현재 진행 중인 작업의 메모리 시작 주소를 경계 레지스터에 저장한 후 작업을 한다.
2) 마지막 주소까지의 차이를 한계 레지스터에 저장한다.
3) 사용자의 작업이 진행되는 동안 이 두 레지스터의 주소 범위를 벗어나는지 하드웨어적으로 점검함으로써 메모리를 보호한다.
4) 만약 두 레지스터의 값을 벗어난다면 메모리 오류와 관련된 언터럽트가 발생한다.
5) 인터럽트가 발생하면 모든 작업이 중단되고 CPU는 운영체제를 깨워서 언터럽트를 처리하도록 시킨다.
6) 메모리 영역을 벗어나서 발생한 인터럽트의 경우 운영체제가 해당 프로그램을 강제 종료시킨다.   
   
이처럼 모든 메모리 영역은 하드웨어와 운영체제의 협업에 의해 보호받는다.

### 2.3 부팅
부팅: 컴퓨터를 켰을 때 운영체제를 메모리에 올리는 과정   
1) 사용자가 컴퓨터의 전원을 켜면 롬에 저장된 바이오스가 실행된다.
2) 바이오스는 CPU, 메모리, 하드디스크, 키보드, 마우스와 같은 주요 하드웨어가 제대로 작동하는지 확인한다.
만약 이상이 있으면 삐 소리와 함께 오류 메시지를 출력, 이상이 없다면 하드디스크의 마스터 부트 레코드에 저장된 작은 프로그램을 메모리로 가져와 실행한다.
3) 마스터 부트 레코드에 있는 부트스트랩이 메모리에 올라오면 하드디스크에 저장된 운영체제를 메모리로 불러온다. (따라서 마스터 부트 레코드가 손상되면 운영체제를 실행할 수 없다.)
